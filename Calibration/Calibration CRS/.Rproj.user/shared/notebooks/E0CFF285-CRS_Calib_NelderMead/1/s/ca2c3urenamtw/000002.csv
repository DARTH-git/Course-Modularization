"0","# Write goodness-of-fit function to pass to Nelder-Mead algorithm"
"0","f_gof <- function(v_params){"
"0","  "
"0","  # Run model for parametr set ""v_params"""
"0","  model_res <- run_crs_markov(v_params)"
"0","  "
"0","  # Calculate goodness-of-fit of model outputs to targets"
"0","  v_GOF <- numeric(n_target)"
"0","  # TARGET 1: Survival (""Surv"")"
"0","  # log likelihood  "
"0","  v_GOF[1] <- sum(dnorm(x = lst_targets$Surv$value,"
"0","                        mean = model_res$Surv,"
"0","                        sd = lst_targets$Surv$se,"
"0","                        log = T))"
"0","  "
"0","  # TARGET 2: (if you had more...)"
"0","  # log likelihood"
"0","  # v_GOF[2] <- sum(dnorm(x = lst_targets$Target2$value,"
"0","  #                        mean = model_res$Target2,"
"0","  #                        sd = lst_targets$Target2$se,"
"0","  #                        log = T))"
"0","  "
"0","  # OVERALL"
"0","  # can give different targets different weights"
"0","  v_weights <- rep(1,n_target)"
"0","  # weighted sum"
"0","  GOF_overall <- sum(v_GOF[1:n_target] * v_weights)"
"0","  "
"0","  # return GOF"
"0","  return(GOF_overall)"
"0","}"
