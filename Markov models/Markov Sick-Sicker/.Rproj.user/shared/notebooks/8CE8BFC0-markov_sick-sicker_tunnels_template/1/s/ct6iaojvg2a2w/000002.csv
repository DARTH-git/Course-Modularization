"0","# from Healthy"
"0","a_P_no_trt[""H"", ""H"", ]            <- 1 - (p_HS1 + p_HD)"
"0","a_P_no_trt[""H"", Sick_tunnel[1], ] <- p_HS1"
"0","a_P_no_trt[""H"", ""D"", ]            <- p_HD"
"0",""
"0","# from Sick"
"0","for(i in 1:(tunnel_size - 1)){"
"0","  a_P_no_trt[Sick_tunnel[i], ""H"", ]  <- p_S1H"
"0","  a_P_no_trt[Sick_tunnel[i], Sick_tunnel[i + 1], ] <- 1 - (p_S1H + p_S1S2[i] + p_S1D)"
"0","  a_P_no_trt[Sick_tunnel[i], ""S2"", ] <- p_S1S2[i]"
"0","  a_P_no_trt[Sick_tunnel[i], ""D"", ]  <- p_S1D"
"0","}"
"0","a_P_no_trt[Sick_tunnel[tunnel_size], ""H"", ]  <- p_S1H"
"0","a_P_no_trt[Sick_tunnel[tunnel_size], Sick_tunnel[tunnel_size], ] <- 1 - (p_S1H + p_S1S2[tunnel_size] + p_S1D)"
"0","a_P_no_trt[Sick_tunnel[tunnel_size], ""S2"", ] <- p_S1S2[tunnel_size]"
"0","a_P_no_trt[Sick_tunnel[tunnel_size], ""D"", ] <- p_S1D"
"0",""
"0","# from Sicker"
"0","a_P_no_trt[""S2"", ""S2"", ] <- 1 - p_S2D"
"0","a_P_no_trt[""S2"", ""D"", ]  <- p_S2D"
"0",""
"0","# from Dead"
"0","a_P_no_trt[""D"", ""D"", ] <- 1"
"0",""
"0","# Check if transition matrix is valid (i_e_, each row should add up to 1)"
"0","valid <- apply(a_P_no_trt, 3, function(x) sum(rowSums(x))==n_s_td)"
"0","if (!isTRUE(all.equal(as.numeric(sum(valid)), as.numeric(n_t)))) {"
"0","  stop(""This is not a valid transition Matrix"")"
"0","}"
"0",""
"0","# create transition probability matrix for treatment same as NO treatment"
"0","a_P_trt <- a_P_no_trt"
