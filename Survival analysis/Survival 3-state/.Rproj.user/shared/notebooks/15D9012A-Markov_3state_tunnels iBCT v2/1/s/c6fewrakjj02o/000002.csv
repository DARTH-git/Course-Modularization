"0","# Strategy names"
"0","v_names_str <- c(""ibcbt"", ""no treatment"")  "
"0",""
"0","# Number of strategies"
"0","n_str <- length(v_names_str)"
"0",""
"0","# Markov model parameters"
"0","v_n  <- c(""Active ptsd"", ""Active ptsd w dep"", ""Active ptsd w sub"", ""Remission"", ""Dead"")    # state names"
"0","n_states  <- length(v_n)                # number of states"
"0","cycle_l <- 0.5                          # cycle length (in years)"
"0","start_age <- 37                         # start age"
"0","end_age <- 100                          # age of cohort when model ends"
"0","n_t  <- (end_age-start_age)/cycle_l     # number of cycles"
"0",""
"0",""
"0","#------------ Setting up Tunnels"
"0","n_tunnel_size <- 3"
"0","# ptsd state"
"0","v_ptsd_tunnels <- paste(""Active_ptsd_"", seq(1, n_tunnel_size), sep = """")"
"0","# Create variables for time-dependent model"
"0","v_n_tunnels  <- c(v_ptsd_tunnels, ""Active ptsd w dep"", ""Active ptsd w sub"", ""ptsd remission"", ""Dead"") # state names"
"0","n_states_tunnels  <- length(v_n_tunnels) # number of states"
"0",""
"0","#------------ Setting up age depedent variables (think vlookup in excel)"
"0","# create a table outling age (in integer years) at each cycle"
"0","# as we keep age as an integer (as per canadian life tables) and our cycle length is 6 months people's age increases by 1 integer every 2 cycles"
"0","age_cycle <- cbind(rep(start_age:end_age, each=1/(cycle_l))) # produce a list of ages"
"0","df_X  <- data.frame(ID = 1:length(age_cycle), Age = age_cycle) # copy the above ages into a table"
"0","# import canadian life table information (this has lready been converted to 6 month probabilities)"
"0","mort <- read.csv(""mort.csv"",header=TRUE,fileEncoding=""UTF-8-BOM"")"
"0","# lookup probability for corresponding age each cycle"
"0","p_HD_all <- inner_join(df_X, mort, by = c(""Age""))"
"0",""
"0","# mortality values "
"0","p_ptsd_d <- p_HD_all[,3]  # probability of death for people with ptsd"
"0","rr_d_dep <- 1.57 # relative risk of mortality for people with depression"
"0","p_ptsdwd_d <- p_HD_all[,3]*rr_d_dep  # probability of death for people with ptsd/dep"
"0","rr_d_sub <- 1.57 # RR of mortality for people with substance abuse"
"0","p_ptsdws_d <- p_HD_all[,3]*rr_d_sub  # probability of death for people with ptsd/dep"
"0",""
"0","# transition probabilities"
"0","p_ptsd_r <- 0.04667898 #probability of recovery with ptsd"
"0","p_no_relapse <- 0 # proportion of patiens who would never relapse"
"0","rr_ptsd_r_d <- 0.773 # relative risk of recovery with depression"
"0","rr_ptsd_r_s <- 0.871 # relative risk of recovery with substance abuse"
"0","p_ptsdwd_r <- p_ptsd_r*rr_ptsd_r_d # probability of recovery with ptsd and dep"
"0","p_ptsdws_r <- p_ptsd_r*rr_ptsd_r_s # probability of recovery with ptsd and sub"
"0","p_r_ptsd <- 0.034351852 # proportion of people in remission who relapse"
"0","p_ptsd_sub <- 0.133974596 # prob of developing substance abuse"
"0","p_ptsd_dep <- 0.282755667 # prob of developing depression"
"0",""
"0","# relative risk for treatment effect"
"0","or_ptsd_r_i <- 2.969161586 # odds ratio for treatment effect"
"0","p_ptsd_r_i <- (or_ptsd_r_i*p_ptsd_r/(1-p_ptsd_r))/(1+or_ptsd_r_i*p_ptsd_r/(1-p_ptsd_r)) "
"0",""
"0","# Costs  "
"0","c_ibct  <- 250.8611                 # cost of internet based cog therapy"
"0","c_ptsd  <- 435.4582651              # cost of ptsd state"
"0","c_ptsd_dep  <- 435.4582651          # cost of ptsd w/dep state"
"0","c_ptsd_sub  <- 435.4582651          # cost of ptsd w/sub state"
"0","c_ptsd_r <- 80.3                    # cost of PTSD remission"
"0","c_D <- 0                            # cost when dead"
"0",""
"0","# Utilities"
"0","u_ptsd  <- 0.68                     # utility ptsd  "
"0","u_ptsd_r <- 0.87                    # utility ptsd in remission "
"0","u_ptsd_sub <- 0.58                  # utility ptsd with substance abuse"
"0","u_ptsd_dep <- 0.53                  # utility ptsd with depression"
"0","u_D  <- 0                           # utility when dead"
"0",""
"0","# Discounting"
"0","d_e <- d_c <- 0.015                   # equal discount of costs and QALYs by 1.5%"
"0",""
"0","# calculate discount weights for costs for each cycle based on discount rate d_c"
"0","v_dwc <- 1 / (1 + d_e) ^ (0:n_t) "
"0","# calculate discount weights for effectiveness for each cycle based on discount rate d_e"
"0","v_dwe <- 1 / (1 + d_c) ^ (0:n_t) "
