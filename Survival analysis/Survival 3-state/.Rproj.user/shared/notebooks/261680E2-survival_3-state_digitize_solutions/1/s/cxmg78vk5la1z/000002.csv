"0","# The existing functions in R require the data in a long rather than a wide format"
"0","# convert the data in a way that flexsurv understands using the mstate package"
"0","data_long       <- msprep(time = sim_data, status = status, trans = tmat )"
"0","data_long$trans <- as.factor(data_long$trans) # convert trans to a factor"
"0",""
"0","data_long$from  <- case_when(data_long$from == 1 ~ ""healthy"","
"0","                             data_long$from == 2 ~ ""sick"","
"0","                             data_long$from == 3 ~ ""dead"")"
"0",""
"0","data_long$to    <- case_when(data_long$to == 1 ~ ""healthy"", "
"0","                             data_long$to == 2 ~ ""sick"","
"0","                             data_long$to == 3 ~ ""dead"")"
"0",""
"0","# fit all parametric multistate models simultaneously to the data and extract the AIC/BIC "
"0","# Select the one with the lowest AIC"
"0","fits <- fit.mstate(time =""time"", status = ""status"", trans, data = data_long, "
"0","                   times = times, extrapolate = T )"
"2","NaNs produced"
