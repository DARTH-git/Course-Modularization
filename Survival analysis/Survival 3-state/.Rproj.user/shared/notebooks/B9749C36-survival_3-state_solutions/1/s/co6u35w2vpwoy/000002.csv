"0","# Extract transition probabilities from the best fitting models"
"0","p_HS <- flexsurvreg_prob(object = best.fit_HS, times = times)"
"0","p_HD <- flexsurvreg_prob(object = best.fit_HD, times = times)"
"0","p_SD <- flexsurvreg_prob(object = best.fit_SD, times = times)"
"0",""
"0","# everyone starts in the ""healthy"" state and therefore has not spent time in ""sick"""
"0","v_M_init  <- rep(""healthy"", times = n_i)   "
"0","v_Ts_init <- rep(0, n_i)  # a vector with the time of being sick at the start of the model "
"0",""
"0","# function that generates the transition probabilities per cycle"
"0","Probs <- function(M_t, v_Ts, t) { "
"0","  # Arguments:"
"0","    # M_t: health state occupied by at cycle t (character variable)"
"0","    # v_Ts: vector with the duration of being sick"
"0","    # t:     current cycle "
"0","  # Returns: "
"0","    # transition probabilities for that cycle"
"0","  "
"0","  # create matrix of state transition probabilities"
"0","  m_p_t           <- matrix(0, nrow = n_s, ncol = n_i) "
"0","  # give the state names to the rows"
"0","  rownames(m_p_t) <-  v_n                              "
"0","  "
"0","  # update m_p_t with the appropriate probabilities   "
"0","  # transition probabilities when healthy "
"0","  m_p_t[, M_t == ""healthy""] <- rbind(1 - p_HD[t] - p_HS[t], p_HS[t], p_HD[t])    "
"0","  # transition probabilities when sick "
"0","  m_p_t[, M_t == ""sick""]    <- rbind(0, 1 - p_SD[v_Ts], p_SD[v_Ts])  "
"0","  # transition probabilities when dead     "
"0","  m_p_t[, M_t == ""dead""]    <- rbind(0, 0, 1)                            "
"0","  return(t(m_p_t))"
"0","}       "
