"0","Effs <- function (M_t, df_X, Trt = FALSE, cl = 1) {"
"0","  # M_it: health state occupied by individual i at cycle t (character variable)"
"0","  # df_X: individual characteristics including Age, Sex and the effect modifier of "
"0","  #       the treatment effect"
"0","  # Trt:  is the individual treated? (default is FALSE) "
"0","  # cl:   cycle length (default is 1)"
"0","  "
"0","  u_t <- 0                                 # by default the utility for everyone is zero"
"0","  u_t[M_t == ""H""]  <- u_H                  # update the utility if healthy"
"0","  u_t[M_t == ""S1"" & Trt == FALSE] <- u_S1  # update the utility if sick"
"0","  # update the utility if sick but on treatment (adjust for individual effect modifier) "
"0","  u_t[M_t == ""S1"" & Trt == TRUE]  <- u_Trt * df_X$x[M_t == ""S1""]  "
"0","  u_t[M_t == ""S2""] <- u_S2                       # update the utility if sicker"
"0","  u_t[M_t == ""D""]  <- u_D                        # update the utility if dead"
"0","  "
"0","  QALYs <-  u_t * cl            # calculate the QALYs during cycle t"
"0","  return(QALYs)                 # return the QALYs"
"0","}"
