"0","Probs <- function(M_t, df_X, v_Ts1, v_Ts2, t) { "
"0","  # Arguments:"
"0","    # M_t: health state occupie at cycle t (character variable)"
"0","    # v_Ts: time an individual is sick"
"0","    # t:     current cycle "
"0","  # Returns: "
"0","    # transition probabilities for that cycle"
"0","  "
"0","  # create matrix of state transition probabilities"
"0","  m_p_t           <- matrix(0, nrow = n_s, ncol = n_i) "
"0","  rownames(m_p_t) <-  v_n  # give the state names to the rows"
"0","  "
"0","  # lookup baseline probability and rate of dying based on individual characteristics"
"0","  p_HD_all <- inner_join(df_X, p_mort, by = c(""Age""))"
"0","  p_HD     <- p_HD_all[M_t == ""H"", ""p_HD""]"
"0","  "
"0","  # update the v_p with the appropriate probabilities   "
"0","  # transition probabilities when healthy"
"0","  m_p_t[, M_t == ""H""]  <- rbind(1 - p_HS1 - p_HD, p_HS1, 0, p_HD)   "
"0","  # transition probabilities when sick"
"0","  m_p_t[, M_t == ""S1""] <- rbind(p_S1H[v_Ts1], 1 - p_S1H[v_Ts1] - p_S1S2[v_Ts1] - "
"0","                                p_S1D[v_Ts1], p_S1S2[v_Ts1], p_S1D[v_Ts1])  "
"0","  # transition probabilities when sicker"
"0","  m_p_t[, M_t == ""S2""] <- rbind(0, 0, 1 - p_S2D[v_Ts2], p_S2D[v_Ts2])                   "
"0","  # transition probabilities when dead  "
"0","  m_p_t[, M_t == ""D""]  <- rbind(0, 0, 0, 1)                                                         "
"0","  return(t(m_p_t))"
"0","}       "
