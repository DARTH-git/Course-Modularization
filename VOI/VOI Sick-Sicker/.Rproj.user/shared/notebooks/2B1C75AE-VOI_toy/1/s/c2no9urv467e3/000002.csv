"0","sel_params_rct <- c(3, 4)"
"0","# Vector with samples to evaluate EVPSI for a RCT"
"0","n_rct <- c(0, 1, 5, 10, seq(20, 200, by = 20))"
"0","n_rct_samples <- length(n_rct)"
"0","# Initailize EVPSI matrix for a combination of parameters"
"0","evsi_rct <- data.frame(Study = ""RCT"","
"0","                        N = n_rct, "
"0","                        EVSI = matrix(0, nrow = n_rct_samples, ncol = 1))"
"0",""
"0","### Estimate linear metamodel of two parameters"
"0","lmm1_rct <- gam(loss[, 1] ~ s(x[, sel_params_rct[1]]) + "
"0","                  s(x[, sel_params_rct[2]]) + "
"0","                  ti(x[, sel_params_rct[1]], x[, sel_params_rct[2]]))"
"0","lmm2_rct <- gam(loss[, 2] ~ s(x[, sel_params_rct[1]]) + "
"0","                  s(x[, sel_params_rct[2]]) + "
"0","                  ti(x[, sel_params_rct[1]], x[, sel_params_rct[2]]))"
"0","lmm3_rct <- gam(loss[, 3] ~ s(x[, sel_params_rct[1]]) + "
"0","                  s(x[, sel_params_rct[2]]) + "
"0","                  ti(x[, sel_params_rct[1]], x[, sel_params_rct[2]]))"
"0","# Predict Loss using Splines"
"0","Lhat_rct_splines <- cbind(lmm1_rct$fitted, lmm2_rct$fitted, lmm3_rct$fitted)"
"0",""
"0","# Compute EVPPI"
"0","evppi_rct <- mean(rowMaxs(Lhat_rct_splines))"
"0","evppi_rct          "
"1","[1]"
"1"," 3650.067"
"1","
"
"0","## Compute EVSI over different sample sizes"
"0","for (nSamp in 1:n_rct_samples){"
"0","  Ltilde1_rct <- predict.ga(lmm1_rct, n = n_rct[nSamp], n0 = n0[sel_params_rct])"
"0","  Ltilde2_rct <- predict.ga(lmm2_rct, n = n_rct[nSamp], n0 = n0[sel_params_rct])"
"0","  Ltilde3_rct <- predict.ga(lmm3_rct, n = n_rct[nSamp], n0 = n0[sel_params_rct])"
"0","  ## Combine losses into one matrix"
"0","  Ltilde_rct <- cbind(Ltilde1_rct, Ltilde2_rct, Ltilde3_rct)"
"0","  ### Apply EVSI equation"
"0","  evsi_rct$EVSI[nSamp] <- mean(rowMaxs(Ltilde_rct))"
"0","}"
"1","[1]"
"1"," ""Variance reduction factor = 0"""
"1"," ""Variance reduction factor = 0"""
"1","
"
"1","[1]"
"1"," ""Variance reduction factor = 0"""
"1"," ""Variance reduction factor = 0"""
"1","
"
"1","[1]"
"1"," ""Variance reduction factor = 0"""
"1"," ""Variance reduction factor = 0"""
"1","
"
"1","[1]"
"1"," ""Variance reduction factor = 0.302"""
"1"," ""Variance reduction factor = 0.302"""
"1","
"
"1","[1]"
"1"," ""Variance reduction factor = 0.302"""
"1"," ""Variance reduction factor = 0.302"""
"1","
"
"1","[1]"
"1"," ""Variance reduction factor = 0.302"""
"1"," ""Variance reduction factor = 0.302"""
"1","
"
"1","[1]"
"1"," ""Variance reduction factor = 0.577"""
"1"," ""Variance reduction factor = 0.577"""
"1","
"
"1","[1]"
"1"," ""Variance reduction factor = 0.577"""
"1"," ""Variance reduction factor = 0.577"""
"1","
"
"1","[1]"
"1"," ""Variance reduction factor = 0.577"""
"1"," ""Variance reduction factor = 0.577"""
"1","
"
"1","[1]"
"1"," ""Variance reduction factor = 0.707"""
"1"," ""Variance reduction factor = 0.707"""
"1","
"
"1","[1]"
"1"," ""Variance reduction factor = 0.707"""
"1"," ""Variance reduction factor = 0.707"""
"1","
"
"1","[1]"
"1"," ""Variance reduction factor = 0.707"""
"1"," ""Variance reduction factor = 0.707"""
"1","
"
"1","[1]"
"1"," ""Variance reduction factor = 0.816"""
"1"," ""Variance reduction factor = 0.816"""
"1","
"
"1","[1]"
"1"," ""Variance reduction factor = 0.816"""
"1"," ""Variance reduction factor = 0.816"""
"1","
"
"1","[1]"
"1"," ""Variance reduction factor = 0.816"""
"1"," ""Variance reduction factor = 0.816"""
"1","
"
"1","[1]"
"1"," ""Variance reduction factor = 0.894"""
"1"," ""Variance reduction factor = 0.894"""
"1","
"
"1","[1]"
"1"," ""Variance reduction factor = 0.894"""
"1"," ""Variance reduction factor = 0.894"""
"1","
"
"1","[1]"
"1"," ""Variance reduction factor = 0.894"""
"1"," ""Variance reduction factor = 0.894"""
"1","
"
"1","[1]"
"1"," ""Variance reduction factor = 0.926"""
"1"," ""Variance reduction factor = 0.926"""
"1","
"
"1","[1]"
"1"," ""Variance reduction factor = 0.926"""
"1"," ""Variance reduction factor = 0.926"""
"1","
"
"1","[1]"
"1"," ""Variance reduction factor = 0.926"""
"1"," ""Variance reduction factor = 0.926"""
"1","
"
"1","[1]"
"1"," ""Variance reduction factor = 0.943"""
"1"," ""Variance reduction factor = 0.943"""
"1","
"
"1","[1]"
"1"," ""Variance reduction factor = 0.943"""
"1"," ""Variance reduction factor = 0.943"""
"1","
"
"1","[1]"
"1"," ""Variance reduction factor = 0.943"""
"1"," ""Variance reduction factor = 0.943"""
"1","
"
"1","[1]"
"1"," ""Variance reduction factor = 0.953"""
"1"," ""Variance reduction factor = 0.953"""
"1","
"
"1","[1]"
"1"," ""Variance reduction factor = 0.953"""
"1"," ""Variance reduction factor = 0.953"""
"1","
"
"1","[1]"
"1"," ""Variance reduction factor = 0.953"""
"1"," ""Variance reduction factor = 0.953"""
"1","
"
"1","[1]"
"1"," ""Variance reduction factor = 0.961"""
"1"," ""Variance reduction factor = 0.961"""
"1","
"
"1","[1]"
"1"," ""Variance reduction factor = 0.961"""
"1"," ""Variance reduction factor = 0.961"""
"1","
"
"1","[1]"
"1"," ""Variance reduction factor = 0.961"""
"1"," ""Variance reduction factor = 0.961"""
"1","
"
"1","[1]"
"1"," ""Variance reduction factor = 0.966"""
"1"," ""Variance reduction factor = 0.966"""
"1","
"
"1","[1]"
"1"," ""Variance reduction factor = 0.966"""
"1"," ""Variance reduction factor = 0.966"""
"1","
"
"1","[1]"
"1"," ""Variance reduction factor = 0.966"""
"1"," ""Variance reduction factor = 0.966"""
"1","
"
"1","[1]"
"1"," ""Variance reduction factor = 0.97"""
"1"," ""Variance reduction factor = 0.97"""
"1","
"
"1","[1]"
"1"," ""Variance reduction factor = 0.97"""
"1"," ""Variance reduction factor = 0.97"""
"1","
"
"1","[1]"
"1"," ""Variance reduction factor = 0.97"""
"1"," ""Variance reduction factor = 0.97"""
"1","
"
"1","[1]"
"1"," ""Variance reduction factor = 0.973"""
"1"," ""Variance reduction factor = 0.973"""
"1","
"
"1","[1]"
"1"," ""Variance reduction factor = 0.973"""
"1"," ""Variance reduction factor = 0.973"""
"1","
"
"1","[1]"
"1"," ""Variance reduction factor = 0.973"""
"1"," ""Variance reduction factor = 0.973"""
"1","
"
"1","[1]"
"1"," ""Variance reduction factor = 0.976"""
"1"," ""Variance reduction factor = 0.976"""
"1","
"
"1","[1]"
"1"," ""Variance reduction factor = 0.976"""
"1"," ""Variance reduction factor = 0.976"""
"1","
"
"1","[1]"
"1"," ""Variance reduction factor = 0.976"""
"1"," ""Variance reduction factor = 0.976"""
"1","
"
