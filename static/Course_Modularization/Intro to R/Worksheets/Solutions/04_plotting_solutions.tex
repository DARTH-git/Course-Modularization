% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
%
\documentclass[
]{article}
\usepackage{lmodern}
\usepackage{amssymb,amsmath}
\usepackage{ifxetex,ifluatex}
\ifnum 0\ifxetex 1\fi\ifluatex 1\fi=0 % if pdftex
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\IfFileExists{bookmark.sty}{\usepackage{bookmark}}{\usepackage{hyperref}}
\hypersetup{
  pdftitle={Intro to R for Decision Modeling},
  pdfauthor={SickKids and DARTH},
  hidelinks,
  pdfcreator={LaTeX via pandoc}}
\urlstyle{same} % disable monospaced font for URLs
\usepackage[margin=1in]{geometry}
\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{248,248,248}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.94,0.16,0.16}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.77,0.63,0.00}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\BuiltInTok}[1]{#1}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.64,0.00,0.00}{\textbf{#1}}}
\newcommand{\ExtensionTok}[1]{#1}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.00,0.00,0.81}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\ImportTok}[1]{#1}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.13,0.29,0.53}{\textbf{#1}}}
\newcommand{\NormalTok}[1]{#1}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.81,0.36,0.00}{\textbf{#1}}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textit{#1}}}
\newcommand{\RegionMarkerTok}[1]{#1}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.00,0.00,0.00}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.31,0.60,0.02}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{\textbf{\textit{#1}}}}
\usepackage{graphicx,grffile}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
\setlength{\emergencystretch}{3em} % prevent overfull lines
\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
\setcounter{secnumdepth}{-\maxdimen} % remove section numbering

\title{Intro to R for Decision Modeling}
\usepackage{etoolbox}
\makeatletter
\providecommand{\subtitle}[1]{% add subtitle to \maketitle
  \apptocmd{\@title}{\par {\large #1 \par}}{}{}
}
\makeatother
\subtitle{Plotting}
\author{SickKids and DARTH}
\date{11/2/2020}

\begin{document}
\maketitle

Change \texttt{eval} to \texttt{TRUE} if you want to knit this document.

This goal of this worksheet is to introduce and provide guidance on
visuzliaing data using \texttt{ggplot2} and base R. It is seperated into
the following sections:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\item
  Plotting graphs in \texttt{R} using \texttt{ggplot2}
\item
  Plotting graphs in \texttt{R} using base \texttt{R} capabilities
\end{enumerate}

Throughout the course, we will demonstrate code and leave some empty
\emph{code chunks} for you to fill in. We will also provide solutions
after the session.

Feel free to modify this document with your comments and clarifications.

\hypertarget{load-data-into-r}{%
\section{\texorpdfstring{1.0 Load data into
\texttt{R}}{1.0 Load data into R}}\label{load-data-into-r}}

Before we begin this session, we need to load The Framingham dataset
into \texttt{R} as we did in the previous session. The Framingham
dataset we have provided has 3,263 rows. To demonstrate plotting, we
will use a the first 1000 entries from this dataset.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{data <-}\StringTok{ }\KeywordTok{read.csv}\NormalTok{(}\StringTok{'framingham.csv'}\NormalTok{, }\DataTypeTok{header =} \OtherTok{TRUE}\NormalTok{)}
\CommentTok{# Selecting the first 1000 Ids}
\NormalTok{data_small <-}\StringTok{ }\NormalTok{data[}\DecValTok{1}\OperatorTok{:}\DecValTok{1000}\NormalTok{, ]}
\end{Highlighting}
\end{Shaded}

\hypertarget{plotting-graphs-using-ggplot2}{%
\section{\texorpdfstring{1. Plotting graphs using
\texttt{ggplot2}}{1. Plotting graphs using ggplot2}}\label{plotting-graphs-using-ggplot2}}

The package \texttt{ggplot2} is a powerful visualization tool within
\texttt{R}. We can use ggplot to create high-quality publication-ready
graphs.

All ggplot graphs contain four key components:

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  A \texttt{ggplot()} function which outlines what data will be plotted
\item
  An \texttt{aes()} function inside \texttt{ggplot()} that determines
  what parts of the graph will depend on the data.
\item
  A \texttt{geom\_} function indicating the type of graph we are
  creating.
\item
  Graph options not related to the data (placed outside the
  \texttt{aes()} function).
\end{enumerate}

\hypertarget{starting-off-with-scatterplots}{%
\subsection{1.1 Starting off with
Scatterplots}\label{starting-off-with-scatterplots}}

Before we begin plotting, it is important that the \texttt{ggplot2}
package is loaded in \texttt{R}.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{library}\NormalTok{(ggplot2)}
\end{Highlighting}
\end{Shaded}

Let's start by creating a plot with Age (\texttt{AGE}) on the x-axis and
Systolic Blood Pressure (\texttt{SYSBP}) on the y-axis.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{ggplot}\NormalTok{(}\DataTypeTok{data =}\NormalTok{ data_small, }
       \KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =}\NormalTok{ AGE,}
           \DataTypeTok{y =}\NormalTok{ SYSBP)) }
\end{Highlighting}
\end{Shaded}

If we do not specify a \texttt{geom\_} function we get an empty plot. We
can think of \texttt{ggplot()} function as creating a base layer which
we will be adding geometry to. We add \texttt{geom\_} to the original
\texttt{ggplot()} using the \texttt{+} sign.

Lets add a scatter plot to the graph we created above.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{ggplot}\NormalTok{(}\DataTypeTok{data =}\NormalTok{ data_small, }
       \KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =}\NormalTok{ AGE,}\DataTypeTok{y =}\NormalTok{ SYSBP))  }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_point}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\textbf{EXERCISE 1} Create a scatter plot of \texttt{SYSBP} against
\texttt{BMI}.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Your turn}
\KeywordTok{ggplot}\NormalTok{(data_small, }
       \KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =}\NormalTok{ BMI, }\DataTypeTok{y =}\NormalTok{ SYSBP)) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_point}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

There are several asthetic options to customize scatter plots.

\begin{itemize}
\tightlist
\item
  \textbf{color}: Point colour (a variable name if inside \texttt{aes()}
  or the name of a colour ``purple'' or HEX codes ``\#800080'')
\item
  \textbf{shape}: shape of point (a variable name if inside
  \texttt{aes()} or a number between 1-25)
\item
  \textbf{alpha}: transparency of each point (a variable name if inside
  \texttt{aes()}or a number between 0-1 with 0 being completely
  transparent and 1 being solid)
\end{itemize}

You can type \texttt{?geom\_point()} to see the help file for
\texttt{geom\_point()} in the bottom right-hand corner. This will show
the complete list of the asthetics assocaited with \texttt{geom\_point}.

The code below returns a scatter plot of blue points that are 50\%
transparent.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{ggplot}\NormalTok{(data_small, }
       \KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =}\NormalTok{ BMI, }\DataTypeTok{y =}\NormalTok{ SYSBP)) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_point}\NormalTok{( }\DataTypeTok{colour =} \StringTok{'blue'}\NormalTok{, }
              \DataTypeTok{alpha =} \FloatTok{0.5}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

Note that if the asthetics should vary depending on the data, i.e.~the
colour changes due to the subgroup, then they should be included within
the \texttt{aes()} function. For example, we can vary the colour of the
points by age.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{ggplot}\NormalTok{(data_small, }
       \KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =}\NormalTok{ BMI, }\DataTypeTok{y =}\NormalTok{ SYSBP, }\DataTypeTok{color =}\NormalTok{ AGE)) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_point}\NormalTok{( }\DataTypeTok{alpha =} \FloatTok{0.75}\NormalTok{) }
\end{Highlighting}
\end{Shaded}

\textbf{EXERCISE 2} Make the colour vary in the graph of \texttt{SYSBP}
against \texttt{BMI} based on Prevalent Hypertensive (PREVHYP).

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Your turn}
\NormalTok{t2 <-}\StringTok{ }\KeywordTok{ggplot}\NormalTok{(data_small, }
       \KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =}\NormalTok{ BMI, }\DataTypeTok{y =}\NormalTok{ SYSBP, }\DataTypeTok{color =}\NormalTok{ PREVHYP)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_point}\NormalTok{(}\DataTypeTok{alpha =} \FloatTok{0.75}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

In the plot above, you can see that there are two distinct categories
for \texttt{PREVHYP} but \texttt{ggplot} has used a colour scale from 0
to 1. This is because \texttt{ggplot} treats numbers as numerical
variables rather than understanding that the numbers code two distinct
categories (\texttt{0} means free from hypertension and \texttt{1} means
the participant has hypertension). Therefore, to improve the plot, we
need to use the \texttt{factor()} function to turn \texttt{PREVHYP} into
a categorical variable:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{data_small}\OperatorTok{$}\NormalTok{PREVHYP.fct <-}\StringTok{  }\KeywordTok{factor}\NormalTok{(data_small}\OperatorTok{$}\NormalTok{PREVHYP, }
                                    \DataTypeTok{levels =} \DecValTok{0}\OperatorTok{:}\DecValTok{1}\NormalTok{, }
                                    \DataTypeTok{labels =} \KeywordTok{c}\NormalTok{(}\StringTok{'Free of disease'}\NormalTok{,}
                                              \StringTok{'Prevalent disease'}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\textbf{EXERCISE 3} Plot a scatter plot with two variables from the
Framingham dataset while making colour vary based on
\texttt{PREVHYP.fct}.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Your turn}
\KeywordTok{ggplot}\NormalTok{(data_small, }
       \KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =}\NormalTok{ BMI, }\DataTypeTok{y =}\NormalTok{ SYSBP, }\DataTypeTok{color =}\NormalTok{ PREVHYP.fct)) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_point}\NormalTok{(}\DataTypeTok{alpha =} \FloatTok{0.75}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{labeling-plots-themes}{%
\subsection{1.2 Labeling plots \& Themes}\label{labeling-plots-themes}}

The \texttt{ggplot2} package contains several functions to change titles
and labels of plot elements. - \texttt{xlab()} \& \texttt{ylab()} change
axis labels. - \texttt{ggtitle()} adds a title and a subtitle

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{ggplot}\NormalTok{(data_small, }
      \KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =}\NormalTok{ AGE, }\DataTypeTok{y =}\NormalTok{ SYSBP, }\DataTypeTok{color =} \KeywordTok{factor}\NormalTok{(PREVHYP.fct))) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_point}\NormalTok{(}\DataTypeTok{alpha =} \FloatTok{0.75}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{xlab}\NormalTok{(}\DataTypeTok{label =} \StringTok{"Age, Years"}\NormalTok{) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{ylab}\NormalTok{(}\DataTypeTok{label =} \StringTok{"Systolic Blood Pressure"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ggtitle}\NormalTok{(}\DataTypeTok{label =} \StringTok{"Figure 1: Age and Systolic Blood Pressure"}\NormalTok{, }
          \DataTypeTok{subtitle =} \StringTok{"Stratified by prevalence of hypertension"}\NormalTok{) }
\end{Highlighting}
\end{Shaded}

We can also use functions of the form
scale\_\emph{asthetic}\_\emph{type} to change the legend for arguments
passed in \texttt{aes()}. These different functions are named so the
\emph{aesthetic} is the aesthetic that we want to name, e.g.~color, fill
shape, alpha, and \emph{type} is the format of the data that is plotted
with that aesthetic e.g.~continuous, discrete, date.

For example, to change the name of the legend associated with the
prevalence of hypertension, we use \texttt{scale\_color\_discrete()}.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{ggplot}\NormalTok{(data_small, }
      \KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =}\NormalTok{ AGE, }\DataTypeTok{y =}\NormalTok{ SYSBP, }\DataTypeTok{color =} \KeywordTok{factor}\NormalTok{(PREVHYP.fct))) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_point}\NormalTok{(}\DataTypeTok{alpha =} \FloatTok{0.75}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{xlab}\NormalTok{(}\DataTypeTok{label =} \StringTok{"Age, Years"}\NormalTok{) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{ylab}\NormalTok{(}\DataTypeTok{label =} \StringTok{"Systolic Blood Pressure"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ggtitle}\NormalTok{(}\DataTypeTok{label =} \StringTok{"Figure 1: Age and Systolic Blood Pressure"}\NormalTok{, }
          \DataTypeTok{subtitle =} \StringTok{"Stratified by prevalence of hypertension"}\NormalTok{) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{scale_color_discrete}\NormalTok{(}\DataTypeTok{name =} \StringTok{"Prevalence of hypertension"}\NormalTok{ )}
\end{Highlighting}
\end{Shaded}

We can also change the background of a plot using the \texttt{theme\_}
functions. For example, the default colour for a ggplot is grey (as we
see above) but the following graphic has a white background with a black
box around using the \texttt{theme\_bw()} function. You can find more
ggplot2 themes in the \texttt{ggthemes} package.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{ggplot}\NormalTok{(data_small, }
      \KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =}\NormalTok{ AGE, }\DataTypeTok{y =}\NormalTok{ SYSBP, }\DataTypeTok{color =} \KeywordTok{factor}\NormalTok{(PREVHYP.fct))) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_point}\NormalTok{(}\DataTypeTok{alpha =} \FloatTok{0.75}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{xlab}\NormalTok{(}\DataTypeTok{label =} \StringTok{"Age, Years"}\NormalTok{) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{ylab}\NormalTok{(}\DataTypeTok{label =} \StringTok{"Systolic Blood Pressure"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ggtitle}\NormalTok{(}\DataTypeTok{label =} \StringTok{"Figure 1: Age and Systolic Blood Pressure"}\NormalTok{, }
          \DataTypeTok{subtitle =} \StringTok{"Stratified by prevalence of hypertension"}\NormalTok{) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{scale_color_discrete}\NormalTok{(}\DataTypeTok{name =} \StringTok{"Prevalence of hypertension"}\NormalTok{ ) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{theme_bw}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

We can also plot two different types of the same data using two
alternative \texttt{geom\_} functions with the same asthetics. For
example, in the graphic below, we produce a scatterplot of the data
using \texttt{geom\_point()} and then add the fitted line from a linear
model using the \texttt{geom\_smooth()} plot type. For example:

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{ggplot}\NormalTok{(data_small, }
      \KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =}\NormalTok{ AGE, }\DataTypeTok{y =}\NormalTok{ SYSBP, }\DataTypeTok{color =} \KeywordTok{factor}\NormalTok{(PREVHYP.fct))) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_point}\NormalTok{(}\DataTypeTok{alpha =} \FloatTok{0.75}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_smooth}\NormalTok{(}\DataTypeTok{method =} \StringTok{"lm"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{xlab}\NormalTok{(}\DataTypeTok{label =} \StringTok{"Age, Years"}\NormalTok{) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{ylab}\NormalTok{(}\DataTypeTok{label =} \StringTok{"Systolic Blood Pressure"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ggtitle}\NormalTok{(}\DataTypeTok{label =} \StringTok{"Figure 1: Age and Systolic Blood Pressure"}\NormalTok{, }
          \DataTypeTok{subtitle =} \StringTok{"Stratified by prevalence of hypertension"}\NormalTok{) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{scale_color_discrete}\NormalTok{(}\DataTypeTok{name =} \StringTok{"Prevalence of hypertension"}\NormalTok{ ) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{theme_bw}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\hypertarget{axis-limits}{%
\section{Axis limits}\label{axis-limits}}

You can set alternative axis limits using \texttt{ylim()} and
\texttt{xlim()}. This is done by providing the function a vector of
length two indicating where the axis begin and end. Notice that each
time we add an additional element to the plot, we add with a \texttt{+}.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{ggplot}\NormalTok{(data_small, }
      \KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =}\NormalTok{ AGE, }\DataTypeTok{y =}\NormalTok{ SYSBP, }\DataTypeTok{color =} \KeywordTok{factor}\NormalTok{(PREVHYP.fct))) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_point}\NormalTok{(}\DataTypeTok{alpha =} \FloatTok{0.75}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{geom_smooth}\NormalTok{(}\DataTypeTok{method =} \StringTok{"lm"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{xlab}\NormalTok{(}\DataTypeTok{label =} \StringTok{"Age, Years"}\NormalTok{) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{ylab}\NormalTok{(}\DataTypeTok{label =} \StringTok{"Systolic Blood Pressure"}\NormalTok{) }\OperatorTok{+}
\StringTok{  }\KeywordTok{ggtitle}\NormalTok{(}\DataTypeTok{label =} \StringTok{"Figure 1: Age and Systolic Blood Pressure"}\NormalTok{, }
          \DataTypeTok{subtitle =} \StringTok{"Stratified by prevalence of hypertension"}\NormalTok{) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{scale_color_discrete}\NormalTok{(}\DataTypeTok{name =} \StringTok{"Prevalence of hypertension"}\NormalTok{ ) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{ylim}\NormalTok{(}\KeywordTok{c}\NormalTok{(}\DecValTok{0}\NormalTok{,}\DecValTok{300}\NormalTok{))}\OperatorTok{+}
\StringTok{  }\KeywordTok{theme_bw}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\hypertarget{other-graphs}{%
\subsection{Other graphs}\label{other-graphs}}

\textbf{EXERCISE 4}: Create a box plot with \texttt{PREVSTRK.fct}
(Prevalent stroke) on the x-axis and \texttt{SYSBP} (Systolic Blood
Pressure) on the y-axis.

Note: \texttt{?geom\_boxplot} provides the documentation for the
boxplotting function.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Your turn}
\NormalTok{data_small}\OperatorTok{$}\NormalTok{PREVSTRK.fct <-}\StringTok{  }\KeywordTok{factor}\NormalTok{(data_small}\OperatorTok{$}\NormalTok{PREVSTRK, }
                                    \DataTypeTok{levels =} \DecValTok{0}\OperatorTok{:}\DecValTok{1}\NormalTok{, }
                                    \DataTypeTok{labels =} \KeywordTok{c}\NormalTok{(}\StringTok{'Free of disease'}\NormalTok{,}
                                              \StringTok{'Prevalent disease'}\NormalTok{))}

\KeywordTok{ggplot}\NormalTok{(data_small, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =} \KeywordTok{factor}\NormalTok{(PREVSTRK), }\DataTypeTok{y =}\NormalTok{ SYSBP)) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_boxplot}\NormalTok{() }
\end{Highlighting}
\end{Shaded}

\textbf{EXERCISE 5}: Create a histogram of Age stratified by Prevalent
hypertension (\texttt{PREVHYP.fct}).

\begin{itemize}
\item
  \texttt{?geom\_histogram} provides the documentation for the
  boxplotting function.
\item
  \texttt{fill} allows you to change the colour of the histogram (more
  widely it changes the colour of geometry).
\end{itemize}

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Your turn}
\KeywordTok{ggplot}\NormalTok{(data_small, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =}\NormalTok{ AGE, }\DataTypeTok{fill =}\NormalTok{ PREVHYP, }\DataTypeTok{group =}\NormalTok{ PREVHYP)) }\OperatorTok{+}\StringTok{ }
\StringTok{  }\KeywordTok{geom_histogram}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\textbf{EXERCISE 6} Plot the density of age in the Framingham dataset.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Your turn}
\KeywordTok{ggplot}\NormalTok{(data_small, }\KeywordTok{aes}\NormalTok{(}\DataTypeTok{x =}\NormalTok{ AGE)) }\OperatorTok{+}\StringTok{ }\KeywordTok{geom_density}\NormalTok{()}
\end{Highlighting}
\end{Shaded}

\hypertarget{plotting-graphs-using-base-r}{%
\section{\texorpdfstring{2. Plotting graphs using base
\texttt{R}}{2. Plotting graphs using base R}}\label{plotting-graphs-using-base-r}}

While \texttt{ggplot2} offers extensive customizability and
publication-standard graphics, there are some basic plotting
capabilities in \texttt{R} that are sufficient, and often preffered, for
exploratory analysis.

\hypertarget{scatter-plot}{%
\subsection{Scatter plot}\label{scatter-plot}}

Suppose you want to create a scatter plot of two variables you can
simply use the \texttt{plot()} function. The following command plots
heart rate and Systolic blood pressure

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot}\NormalTok{(}\DataTypeTok{x =}\NormalTok{ data_small}\OperatorTok{$}\NormalTok{BMI,}\DataTypeTok{y =}\NormalTok{  data_small}\OperatorTok{$}\NormalTok{SYSBP, }
     \DataTypeTok{col =} \StringTok{'blue'}\NormalTok{,}
     \DataTypeTok{main =} \StringTok{'Scatter plot of systolic blood pressure against BMI'}\NormalTok{, }
     \DataTypeTok{xlab =} \StringTok{'BMI'}\NormalTok{, }\DataTypeTok{ylab =} \StringTok{'systolic blood pressure'}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\textbf{EXERCISE 7} Re-create the scatter plot you made in EXERCISE 3
using the base plotting function. Make appropriate titles and labels.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{plot}\NormalTok{(data_small}\OperatorTok{$}\NormalTok{AGE, data_small}\OperatorTok{$}\NormalTok{HEARTRTE, }
     \DataTypeTok{col =} \StringTok{'green'}\NormalTok{,}
     \DataTypeTok{main =} \StringTok{'Scatter plot of heart rate against age'}\NormalTok{, }
     \DataTypeTok{xlab =} \StringTok{'age'}\NormalTok{, }\DataTypeTok{ylab =} \StringTok{'heart rate'}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{box-plot}{%
\subsection{Box plot}\label{box-plot}}

The following code creates a box plot of \texttt{SYSBP} stratified by
\texttt{PREVSTRK}.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{boxplot}\NormalTok{(SYSBP }\OperatorTok{~}\StringTok{ }\NormalTok{PREVSTRK ,}\DataTypeTok{data=}\NormalTok{data_small, }
        \DataTypeTok{main=}\StringTok{"Box plot of systolic blood pressure stratified }
\StringTok{        by prevalent stroke"}\NormalTok{,}
        \DataTypeTok{names =} \KeywordTok{c}\NormalTok{(}\StringTok{'free of disease'}\NormalTok{, }\StringTok{'prevalent disease'}\NormalTok{),}
        \DataTypeTok{col =} \KeywordTok{c}\NormalTok{(}\StringTok{'red'}\NormalTok{, }\StringTok{'blue'}\NormalTok{),}
        \DataTypeTok{xlab =} \StringTok{"prevalent stroke"}\NormalTok{, }\DataTypeTok{ylab=}\StringTok{"systolic blood pressure"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

The \texttt{\textasciitilde{}} symbol is frequently used in \texttt{R}
to define formulas (which we will see in the Regression session), but
here indicates that you want to plot the continuous variable
\texttt{SYSBP} across the two categories of \texttt{PREVSTRK}.

\textbf{EXERCISE 8} Create a box plot of two variables in the Framingham
database with the appropriate title and labels.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Your turn}
\KeywordTok{boxplot}\NormalTok{(AGE }\OperatorTok{~}\StringTok{ }\NormalTok{SEX ,}\DataTypeTok{data=}\NormalTok{data_small, }
        \DataTypeTok{main=}\StringTok{"Box plot of age stratified by sex"}\NormalTok{,}
        \DataTypeTok{names =} \KeywordTok{c}\NormalTok{(}\StringTok{'men'}\NormalTok{, }\StringTok{'women'}\NormalTok{),}
        \DataTypeTok{col =} \KeywordTok{c}\NormalTok{(}\StringTok{'yellow'}\NormalTok{, }\StringTok{'purple'}\NormalTok{),}
        \DataTypeTok{xlab =} \StringTok{"sex"}\NormalTok{, }\DataTypeTok{ylab=}\StringTok{"age"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{histogram}{%
\subsection{Histogram}\label{histogram}}

The following command creates a histogram showing the distribution of
\texttt{AGE} with appropriate labelling.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{hist}\NormalTok{(data_small}\OperatorTok{$}\NormalTok{BMI, }\DataTypeTok{main =} \StringTok{'Histogram of age'}\NormalTok{, }\DataTypeTok{xlab =} \StringTok{'age'}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\textbf{EXERCISE 9} Create a histogram of BMI with smaller sized bins
(hint: explore \texttt{?hist()} and the \texttt{breaks} option).

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Your turn}
\KeywordTok{hist}\NormalTok{(data_small}\OperatorTok{$}\NormalTok{BMI, }\DataTypeTok{main =} \StringTok{'Histogram of BMI'}\NormalTok{, }\DataTypeTok{xlab =} \StringTok{'BMI'}\NormalTok{, }
     \DataTypeTok{breaks =} \DecValTok{20}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\hypertarget{other-types-of-graphs}{%
\subsection{Other types of graphs}\label{other-types-of-graphs}}

Several R functions have output which the \texttt{plot()} function
understands intunitively how to visualize. For example the
\texttt{density()} funciton calculates kernel density estimates of a
vector. When we call the \texttt{plot()} function to the results of
\texttt{density()} we get a meaninful plot.

Not all output from \texttt{R} functions can be plotted.

\begin{Shaded}
\begin{Highlighting}[]
\CommentTok{# Plotting output of (density)}
\NormalTok{den.age <-}\StringTok{ }\KeywordTok{density}\NormalTok{(data_small}\OperatorTok{$}\NormalTok{AGE)}
\NormalTok{den.age}
\KeywordTok{plot}\NormalTok{(den.age, }\DataTypeTok{main =} \StringTok{'Density plot of age'}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\end{document}
